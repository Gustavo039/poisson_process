---
title: "Processo de Poisson Homogeneo, um estudo sobre simulação e inferencia"
author: "Gustavo Almeida Silva"
date: "23/07/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Parte 1: Simulação de um Processo de Poisson
O processo é um processo de contagem, ou seja, quantificar quantas observações foram registradas em algum determinado espaço de tempo. 
Esse processo possui propriedades importantissimas, onde a função desenvolvida nesse trabalho para simular um Processo de Poisson, se utiliza delas:

* Propriedade de falta de memoria
   + Diz respeito a estrutura condicional do processo, onde a probabilidade de ocorrer alguma observação ebtre os tempos $T_1$ e $T_2$ é independente do numero de observaçoes registradas entre $T_0$ e $T_1$
   
* Propriedade do Tempo de Chegada: distribuicao e independencia
  + O intervalo de tempo entre a chegada de 2 observaçoes segue uma distrinuição Exponencial, onde por conta do processo possuir a propriedade de falta de memoria, esses $T_i$ são IID. Assim, a soma de tempos de chegada segue uma Gama
 


 Com essas propriedades em mãos, pode-se desenvolver uma função que simula um Processo de Posson, onde dado um lambda (taxa de chegada por tempo), estima-se o tempo de chegada entre as observações durante n passos(comprimento da simulação)
```{r}
poi_process <- function(lambda,n){
  
  # initialize vector of total wait time for the arrival of each event:
  s<-numeric(n+1)
  # set S_0 = 0
  s[1] <-0
  # generate vector of iid Exp random variables:
  x <-replicate(n,rexp(1,lambda))
  # assign wait time to vector s in for loop:
  for (k in 1:n){
    
    s[k+1] <-sum(x[1:k])
    
  }
  # return vector of wait time
  return(s)
  
}

```

## Função de plot
```{r}
poi_plot=function(data,lambda,n){
plot(stepfun(data, 1:(n+2)), 
     do.points = TRUE,
     pch = 16,
     col.points = "red",
     verticals = FALSE,
     main = paste('Simulação de um Processo de Poisson com lambda =',lambda),
     xlab = 'Tempo de Chegada',
     ylab = 'Numero de observações')
}
```

## Teste da função
```{r}
n=20
lambda=sample(c(1:10),1)
paste('Seja n:',n,'e lambda:',lambda)
data=poi_process(lambda,n)
poi_plot(data,lambda,n)
```



```{r}
lambda=sample(c(1:10),1)
paste('Seja n:',n,'e lambda:',lambda)
data=poi_process(lambda,n)
poi_plot(data,lambda,n)
```

```{r}
lambda=sample(c(1:10),1)
paste('Seja n:',n,'e lambda:',lambda)
data=poi_process(lambda,n)
poi_plot(data,lambda,n)
```


## Parte 2: Inferencia em um Processo de Poisson
Assim como é em boa parte das bases de dados, em um Processo de Poisson tambem é possivel estimar paremetros de uma população com base em estimadores calculados a partir de amostras.
Para isso, assumiremos sempre um tempo de observação consideralvemnete grande.

* Propriedade 1:
  + Pela Lei dos Grandes Numeros, temos que: $\lim_{t \to \infty} \frac{N(t)}{t}=\lambda$
 
* Propriedade 2:
  + Como consequencia direta da propriedade 1, $\hat{\lambda}= \frac{n(0,T]}{T}$

Com essas propriedades em mãos, pode-se desenvolver uma função que estima lambda a partir de amostras de uma simulação de Prcoessos de Poisson
```{r}
poi_estim=function(data){
  return(data/length(data))
}
t1=poi_process(2,100)

poi_estim(t1)
```

